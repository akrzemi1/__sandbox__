:sourcedir: .
:last-update-label!:
:source-highlighter: coderay
:icons: font
= Markable - API Reference
Reference
:toclevels: 3
:toc: left
:toc-title:

[reference]
== Reference


### Class template `dual_storage`

Class used to store inside a union members of type `value_type` and `representation_type`, and manage them appropriately.

```c++
template <typename MP>
struct dual_storage
{
  typedef typename MP::value_type value_type;
  typedef typename MP::representation_type representation_type;
  typedef typename MP::reference_type reference_type;
  
  bool has_value() const /*noexcept*/; // need to consider noexcept (if not too harsh)
  value_type&        as_value_type();
  const value_type&  as_value_type() const;
  representation_type&       representation();
  const representation_type& representation() const;
  
  constexpr dual_storage(representation_type&& mv) noexcept(noexcept(representation_type(std::move(mv)))));
  constexpr explicit dual_storage(const value_type& v) noexcept(noexcept(value_type(v))));
  constexpr explicit dual_storage(value_type&& v) noexcept(noexcept(value_type(std::move(v))));
  dual_storage(const dual_storage& rhs); // TODO: add noexcept
  dual_storage(dual_storage&& rhs); // TODO: add noexcept    
  void operator=(const dual_storage& rhs);    
  void operator=(dual_storage&& rhs); // TODO: add noexcept  
  friend void swap(dual_storage& lhs, dual_storage& rhs);  // TODO: add conditional noexcept
  ~dual_storage();
};
```

An object of `dual_storage` contains a union of two members of types `value_type` and `representation_type`.
Such object is said to _have value_ if its active member is of type `value_type`.

#### `bool has_value() const;`
*Returns:* `!MP::is_marked_value(representation())`.

*Remarks:* This tests if the object has value.

#### `~dual_storage();`
*Effects:* if `has_value() == true`, destroys the active member of type `value_type`, otherwise destroys the active member of `representation_type`.

